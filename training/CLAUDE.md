# 基础规范
调用sequential-thinking来解决问题，并且不要进行错误的try和catch，这会显著增加debug的麻烦，就直接让错误暴露出来。而不是总是在最外层增加try catch函数来让错误被隐藏。
# 已完成
## Training 模块设计文档

## 任务概述
基于已完成的 @models (FluidDecoder) 和 @data (数据处理) 模块，设计完整的训练框架。

## 核心架构选择
**使用 🤗 Transformers Trainer** - 成熟稳定的训练框架，提供自动混合精度、分布式训练、实验跟踪等功能。

## 主要模块设计

### 1. HuggingFace 集成适配

### 2. 训练配置和控制
- **TrainingArguments** - 完整的训练参数配置
- **实验跟踪** - swanlab/TensorBoard 集成
- **混合精度训练** - FP16 自动优化
- **梯度裁剪和累积** - 稳定训练的关键技术

### 3. 评估指标系统
- **设备分组评估**: B(球阀)、C(压缩机)、H(管段)、N(节点)、P(管道)、R(调节阀)、T&E(气源分输)
- **掩码损失**: 只对设备变量计算损失，忽略边界条件

## 核心训练流程
1. **数据准备** - 加载训练/验证数据集，应用归一化
2. **训练配置** - 设置 TrainingArguments 参数
3. **训练执行** - Trainer 自动化训练循环
4. **模型保存** - 保存最佳检查点和最终模型，最后report to SwanLab的 Swanlog

# 已修复的bug 
✅ 已移除 compute_fluid_metrics 函数引用
✅ 简化了 compute_metrics 逻辑 - 直接使用模型自动计算的 loss 作为主要指标
✅ 训练代码现在完全兼容 HuggingFace Trainer，支持自动混合精度训练

## 已完成
就是我不希望一个参数一个参数在命令行传递，你应该做的是有一个config文件，然后会有一些示例值可以直接从文件里面读取。尽量让这个入口函数train.py变得简洁。

## 已完成
现在你需要把这个train.py放到根目录下，因为train最后需要调用很多仓库，最后执行的文件一定最好是从根目录下面执行是比较好的。evaluate.py应该也在根目录，就是你想整个项目的执行入口都应该是在根目录。不然就会出现循环引用的问题。